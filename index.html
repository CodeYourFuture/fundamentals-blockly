<html>
  <head>
    <title>CYF Blocks - Unblock your future!</title>
    

    <link rel="stylesheet" href="./style.css" />
    <script type="module" src="https://cdn.jsdelivr.net/gh/zerodevx/zero-md@2/dist/zero-md.min.js"></script>
  </head>
  <body>
    <script src="https://unpkg.com/blockly@7.20211209.0/blockly.min.js"></script>
    <script src="blockly-dom.js"></script>
    <script src="blockly-cyf.js"></script>
    <script src="jsoncrush.js"></script>
    <script src="editor.js"></script>

     <header>
      <h1>CYF Blocks</h1>
      <button onclick="getElementById('toc').classList.toggle('open')">
        <span style="position: absolute;transform: translateY(-100vh);">Menu</span> 
        <svg viewBox="0 0 100 80" width="30" height="30">
        <rect width="100" height="10" fill="currentColor"></rect>
        <rect y="30" width="100" height="10" fill="currentColor"></rect>
        <rect y="60" width="100" height="10" fill="currentColor"></rect>
        </svg>
      </button>
    </header>
    <nav id="toc"></nav>
    <div id="exercises">
      
      <div class="exercise" id="introduction">
      <h2>Introduction</h2>
      <div class="instructions">
        <zero-md src="exercises/introduction.md"></zero-md>
      </div>
      </div>
      <div class="exercise" id="exercise_change_text">
      <h2>Modifying html dynamically: changing text</h2>
      <script>
      BlocklyTest.registerTest("exercise_change_text", () => {
        let noun1 = BlocklyTest.findElement(["#noun1"]);
        let noun2 = BlocklyTest.findElement(["#noun2"]);
        let verb = BlocklyTest.findElement(["#verb"]);
        let adjective = BlocklyTest.findElement(["#adjective"]);
        BlocklyTest.expect(1, "first noun was changed", adjective, (adjective) => {
          return adjective.innerText !== "___";
        });

        BlocklyTest.expect(2, "all words were changed", noun1, (noun1) => {
          return (
            noun1.innerText.toLowerCase() !== "dog" &&
            noun2.innerText.toLowerCase() !== "cat" &&
            adjective.innerText.toLowerCase() !== "___" &&
            verb.innerText.toLowerCase() !== "saw"
          )
        });
      });
    </script>
      <div class="instructions" >
        <zero-md src="exercises/changing_text.md" ></zero-md>
      </div>
       <xml class="toolbox" style="display: none">
          <category name="Values" colour='%{BKY_TEXTS_HUE}'>
            <block type="text"></block>
            <block type="get_randomWord"></block>
          </category>
          <category name="Html" colour="%{BKY_COLOUR_HUE}">
            <block type="on_start"></block>
            <block type="with_element_by_id"></block>
            <block type="set_content">
              <value name="VALUE">
                <shadow type="text"> </shadow>
              </value>
            </block>
          </category>
        </xml>
      </div>

      
      <div class="exercise" id="exercise_set_colours">
      <h2>Modifying html dynamically: setting colours</h2>
      <script>
      BlocklyTest.registerTest("exercise_set_colours", () => {
        let firstLi = BlocklyTest.findElement(["#banana", "li:nth-child(1)"]);
        let startColor = window.getComputedStyle(firstLi).color;
        BlocklyTest.expect(1, "colour was changed", firstLi, (li) => {
          return window.getComputedStyle(li).color != startColor;
        })
        let startBackgroundColor = window.getComputedStyle(firstLi).backgroundColor;
        BlocklyTest.expect(2, "background colour was changed", firstLi, (li) => {
          return window.getComputedStyle(li).backgroundColor != startBackgroundColor;
        })
        if (firstLi) {
          BlocklyTest.expect(3, "all colours are changed", firstLi.parentElement, (ul) => {
            return ul.children.length > 1 && Array.from(ul.children).every((li) => window.getComputedStyle(li).color != startColor);
          })
        }
      });
    </script>
      <div class="instructions">
      <zero-md src="exercises/set_colours.md"></zero-md>
       </div>
       <xml class="toolbox" style="display: none">
          <category name="Values" colour='%{BKY_TEXTS_HUE}'>
            <block type="math_number"></block>
            <block type="text"></block>
            <block type="colour_picker"></block>
            <block type="logic_boolean"></block>
          </category>
          <category name="Html" colour="%{BKY_COLOUR_HUE}">
            <block type="on_start"></block>
            <block type="with_element_by_id"></block>
            <block type="set_content">
              <value name="VALUE">
                <shadow type="text"> </shadow>
              </value>
            </block>
            <block type="set_attribute"></block>
          </category>
        </xml>
      </div>
      
      <div class="exercise" id="exercise_add_fruit">
      <h2>Creating html dynamically: lists of fruit</h2>
      <script>
        BlocklyTest.registerTest("exercise_add_fruit", () => {
          let ul = BlocklyTest.findElement(["#list", "ul", "ol"]);
          let startLiCount = 0;
          if (ul) {
            startLiCount = ul.children.length;
          }
          BlocklyTest.expect(1, "Banana is added dynamically as the second item", ul, (ul) => {
            if (startLiCount !== 2 && !ul.children.length == 2) return false;
            return ul.children.item(1).innerText == "Banana" || ul.children.item(1).innerText == "banana" 
          })
          BlocklyTest.expect(2, "There are at least 4 items", ul, (ul) => {
            return ul.children.length >= 4
          })
        });
      </script>
      <div class="instructions">
        <zero-md src="exercises/add_fruit.md"></zero-md>
       </div>
       <xml class="toolbox" style="display: none">
          <category name="Values" colour='%{BKY_TEXTS_HUE}'>
            <block type="math_number"></block>
            <block type="text"></block>
            <block type="colour_picker"></block>
            <block type="logic_boolean"></block>
          </category>
          <category name="Html" colour="%{BKY_COLOUR_HUE}">
            <block type="on_start"></block>
            <block type="with_element_by_id"></block>
            <block type="add_element"></block>
            <block type="set_content">
              <value name="VALUE">
                <shadow type="text"> </shadow>
              </value>
            </block>
            <block type="set_attribute"></block>
          </category>
        </xml>
      </div>
      
      <div class="exercise" id="exercise_list_links">
      <h2>Creating html dynamically: lists of links</h2>
      <script>
        BlocklyTest.registerTest("exercise_list_links", () => {
          let ul = BlocklyTest.findElement(["#list", "ul", "ol"]);
          let startLiCount = 0;
          if (ul) {
            startLiCount = ul.children.length;
          }
          BlocklyTest.expect(1, "There are 3 links with href attributes", ul, (ul) => {
            var lis = Array.from(ul.querySelectorAll("li"));
            return startLiCount != 3 && lis.length == 3 && lis.every((li) => li.querySelector("a[href]") && li.querySelector("a[href]").innerText);
          })
        });
      </script>
      <div class="instructions">
        <zero-md src="exercises/list_links.md"></zero-md>
       </div>
       <xml class="toolbox" style="display: none">
          <category name="Values" colour='%{BKY_TEXTS_HUE}'>
            <block type="math_number"></block>
            <block type="text"></block>
            <block type="colour_picker"></block>
            <block type="logic_boolean"></block>
          </category>
          <category name="Html" colour="%{BKY_COLOUR_HUE}">
            <block type="on_start"></block>
            <block type="with_element_by_id"></block>
            <block type="add_element"></block>
            <block type="set_content">
              <value name="VALUE">
                <shadow type="text"> </shadow>
              </value>
            </block>
            <block type="set_attribute"></block>
          </category>
        </xml>
      </div>
      
      <div class="exercise" id="exercise_button_add">
      <h2>Buttons and clicks: A button to add apples</h2>
      <script>
        BlocklyTest.registerTest("exercise_button_add", () => {
          let ul = BlocklyTest.findElement(["#list", "ul", "ol"]);
          let button = BlocklyTest.findElement(["#button", "button:nth-of-type(1)"]);
          let button2 = BlocklyTest.findElement(["#button2", "button:nth-of-type(2)"]);

          BlocklyTest.expectAfterClick(1, "The button adds an apple", button, 
          () => {
            let count = ul ? ul.children.length : 0;
            return count;
          },
          (countBefore, countAfter) => {
            let addsExactlyOneChild = countBefore + 1 == countAfter
            var lastLi = ul.lastChild;
            return (addsExactlyOneChild && lastLi.innerText.toLowerCase() == "apple");
          });

          BlocklyTest.expectAfterClick(2, "The second button removes all apples", button2, 
          () => {
            let count = ul ? ul.children.length : 0;
            return count;
          },
          (countBefore, countAfter) => countBefore > 0 && countAfter == 0);
        });
      </script>
       <div class="instructions">
        <zero-md src="exercises/add_apples.md"></zero-md>
       </div>
       <xml class="toolbox" style="display: none">
          <category name="Values" colour='%{BKY_TEXTS_HUE}'>
            <block type="math_number"></block>
            <block type="text"></block>
            <block type="colour_picker"></block>
            <block type="logic_boolean"></block>
          </category>
          <category name="Html" colour="%{BKY_COLOUR_HUE}">
            <block type="on_start"></block>
            <block type="element_clicked"></block>
            <block type="with_element_by_id"></block>
            <block type="add_element"></block>
            <block type="set_content">
              <value name="VALUE">
                <shadow type="text"> </shadow>
              </value>
            </block>
            <block type="set_attribute"></block>
            <block type="remove_contents"></block>
          </category>
        </xml>
      </div>
      
      <div class="exercise" id="exercise_button_input">
        <h2>Inputs and clicks: say something</h2>
        <div class="instructions">
           <zero-md src="exercises/say_something.md"></zero-md>
       </div>
       <xml class="toolbox" style="display: none">
          <category name="Values" colour='%{BKY_TEXTS_HUE}'>
            <block type="text"></block>
            <block type="get_randomWord"></block>
            <block type="text_to_speech"></block>
          </category>
          <category name="Html" colour="%{BKY_COLOUR_HUE}">
            <block type="on_start"></block>
            <block type="element_clicked"></block>
            <block type="with_element_by_id"></block>
            <block type="add_element"></block>
            <block type="set_content">
              <value name="VALUE">
                <shadow type="text"> </shadow>
              </value>
            </block>
            <block type="set_attribute"></block>
            <block type="remove_contents"></block>
            <block type="get_input_value_with_id"></block>
          </category>
        </xml>
      </div>

      <div class="exercise" id="exercise_todo_list">
        <h2>Buttons, inputs and clicks: a todo list</h2>
        <div class="instructions">
          <zero-md src="exercises/todo_list.md"></zero-md>
       </div>
       <xml class="toolbox" style="display: none">
          <category name="Values" colour='%{BKY_TEXTS_HUE}'>
            <block type="math_number"></block>
            <block type="text"></block>
            <block type="colour_picker"></block>
            <block type="logic_boolean"></block>
          </category>
          <category name="Html" colour="%{BKY_COLOUR_HUE}">
            <block type="on_start"></block>
            <block type="element_clicked"></block>
            <block type="with_element_by_id"></block>
            <block type="add_element"></block>
            <block type="set_content">
              <value name="VALUE">
                <shadow type="text"> </shadow>
              </value>
            </block>
            <block type="set_attribute"></block>
            <block type="remove_contents"></block>
            <block type="get_input_value_with_id"></block>
          </category>
         <category name="Variables" colour="330" custom="VARIABLE"></category>
        </xml>
      </div>
    
      <div class="exercise" id="exercise_button_consolidation">
        <h2>Buttons and clicks consolidation</h2>
        <div class="instructions">
          <zero-md src="exercises/button_consolidation.md"></zero-md>
       </div>
       <xml class="toolbox" style="display: none">
          <category name="Values" colour='%{BKY_TEXTS_HUE}'>
            <block type="math_number"></block>
            <block type="text"></block>
            <block type="colour_picker"></block>
            <block type="logic_boolean"></block>
            <block type="get_randomWord"></block>
          </category>
          <category name="Html" colour="%{BKY_COLOUR_HUE}">
            <block type="on_start"></block>
            <block type="element_clicked"></block>
            <block type="with_element_by_id"></block>
            <block type="add_element"></block>
            <block type="set_content">
              <value name="VALUE">
                <shadow type="text"> </shadow>
              </value>
            </block>
            <block type="set_attribute"></block>
            <block type="remove_contents"></block>
          </category>
        </xml>
      </div>      
      
      <div class="exercise" id="exercise_button_variables_state">
        <h2>Variables: keeping track of the number of clicks</h2>
        <div class="instructions">
        <p>
          A variable is a name into which a value can be stored. There are several reasons for which we might want to do this. The first is when we want to keep track of a value that changes over time. Let's keep track of the number of times a button is clicked.
        </p>
        <ol>
            <li>Start with a button (<code>&lt;button&gt;</code>) that has been clicked 0 times in the static html. <code class="start_code">&lt;button id="button"&gt;0&lt;/button&gt;</code></li>
            <li>Add an <span class="blockname">"at the start"</span> block. Inside we are going to add a variable that will keep track of the number of times the button was clicked.</li>
                <ol>
                    <li>In the Variables menu, click "create variable..." to create a variable called <code>click_count</code></li>
                    <li>From the Variables menu, create a <span class="blockname">"set click_count to"</span> block and place it inside the <span class="blockname">"at the start"</span></li>
                    <li>Set the value to 0 (from the Values menu)</li>
                </ol>
            </li>
            <li>When the button is clicked, we are going to do two things: increase the value of <code>click_count</code> by 1; and change the text of the button to the new value of click_count.</li>
                <ol>
                    <li>Add an <span class="blockname">"when the element with id ... is clicked"</span> block. </li>
                    <li>Inside this block, add a <span class="blockname">"change click_count by 1"</span> block from the Variables menu.</li>
                    <li>Add the necessary blocks to set the text content of the button to the value of <code>click_count</code>. (You can get this value by selecting the <span class="blockname">"click_count"</span> block from the Variables menu)</li>
                </ol>
            </li>
        </ol>
        <p>Note that it will be a common pattern that you first set a variable in the <span class="blockname">"at the start"</span> block and then modify it in at <span class="blockname">"when the element with id ... is clicked"</span> block. This first setting of the variable is called "initialisation".</p>
       </div>
       <xml class="toolbox" style="display: none">
          <category name="Values" colour='%{BKY_TEXTS_HUE}'>
            <block type="math_number"></block>
            <block type="text"></block>
            <block type="colour_picker"></block>
            <block type="logic_boolean"></block>
          </category>
          <category name="Html" colour="%{BKY_COLOUR_HUE}">
            <block type="on_start"></block>
            <block type="element_clicked"></block>
            <block type="with_element_by_id"></block>
            <block type="add_element"></block>
            <block type="set_content">
              <value name="VALUE">
                <shadow type="text"> </shadow>
              </value>
            </block>
            <block type="set_attribute"></block>
            <block type="remove_contents"></block>
            <block type="get_input_value_with_id"></block>
          </category>
         <category name="Variables" colour="330" custom="VARIABLE"></category>
        </xml>
      </div>
            
      <div class="exercise" id="exercise_button_variables_consolidation">
        <h2>Variables consolidation: counting sheep</h2>
        <div class="instructions">
          <zero-md src="exercises/button_variables_consolidation.md"></zero-md>
       </div>
       <xml class="toolbox" style="display: none">
          <category name="Logic" colour="210">
            <block type="controls_if"></block>
            <block type="logic_negate"></block>
            <block type="logic_compare"></block>
          </category>
          <category name="Values" colour='%{BKY_TEXTS_HUE}'>
            <block type="math_number"></block>
            <block type="text"></block>
            <block type="colour_picker"></block>
            <block type="logic_boolean"></block>
          </category>
          <category name="Html" colour="%{BKY_COLOUR_HUE}">
            <block type="on_start"></block>
            <block type="element_clicked"></block>
            <block type="with_element_by_id"></block>
            <block type="add_element"></block>
            <block type="set_content">
              <value name="VALUE">
                <shadow type="text"> </shadow>
              </value>
            </block>
            <block type="set_attribute"></block>
            <block type="remove_contents"></block>
            <block type="get_input_value_with_id"></block>
          </category>
         <category name="Variables" colour="330" custom="VARIABLE"></category>
        </xml>
      </div>

      
      <div class="exercise" id="exercise_arrays_random">
      <h2>Arrays: Mad Libs revisited</h2>
      <div class="instructions">
        <zero-md src="exercises/arrays_random.md"></zero-md>
      </div>
      <xml class="toolbox" style="display: none">
        <category name="Values" colour='%{BKY_TEXTS_HUE}'>
          <block type="math_number"></block>
          <block type="text"></block>
          <block type="colour_picker"></block>
          <block type="logic_boolean"></block>
        </category>
        <category name="Html" colour="%{BKY_COLOUR_HUE}">
          <block type="on_start"></block>
          <block type="element_clicked"></block>
          <block type="with_element_by_id"></block>
          <block type="add_element"></block>
          <block type="set_content">
            <value name="VALUE">
              <shadow type="text"> </shadow>
            </value>
          </block>
          <block type="set_attribute"></block>
          <block type="remove_contents"></block>
          <block type="element_clicked_current"></block>
          <block type="with_elements_by_selector"></block>
        </category>
        <category name="Arrays" colour="%{BKY_LISTS_HUE}">
          <block type="variables_set">
            <field name="VAR">array</field>
            <value name="VALUE">
              <block type="lists_create_with">
              </block>
            </value>
          </block>
          <block type="get_randomMember">
          <value name="ARRAY">
            <block type="variables_get">
                <field name="VAR">array</field>
            </block>
          </value>
        </block>
        </category>
        <category name="Variables" colour="330" custom="VARIABLE"></category>
      </xml>
      </div>

      <div class="exercise" id="exercise_arrays_foreach">
      <h2>Arrays and loops</h2>
      <script>
        BlocklyTest.registerTest("exercise_arrays_foreach", () => {
          let ul = BlocklyTest.findElement(["#list", "ul", "ol"]);
          let list = BlocklyTest.findArrayValues(0); // first of the arrays is the one we want

          BlocklyTest.expect(1, "One element is shown", ul, (ul) => {
            var lis = Array.from(ul.querySelectorAll("li"));
            return lis.length > 0 && lis[0].innerText == list[0];
          });

          BlocklyTest.expect(2, "As many elements are shown as there are items in the array", ul, (ul) => {
            var lis = Array.from(ul.querySelectorAll("li"));
            return lis.length == list.length;
          });

          BlocklyTest.expect(3, "All the elements in the array (at least 3) are in the html list", ul, (ul) => {
            var lis = Array.from(ul.querySelectorAll("li"));
            return list.length >= 3 && lis.length == list.length && lis.every((li, index) => li.innerText == list[index]);
          });

          BlocklyTest.expect(4, "All the elements in the array (at least 4) are in the html list", ul, (ul) => {
            var lis = Array.from(ul.querySelectorAll("li"));
            return list.length >= 4 && lis.length == list.length && lis.every((li, index) => li.innerText == list[index]);
          });
        });
      </script>
      <div class="instructions">
        <zero-md src="exercises/arrays_foreach.md"></zero-md>
      </div>
      <xml class="toolbox" style="display: none">
        <category name="Values" colour='%{BKY_TEXTS_HUE}'>
          <block type="math_number"></block>
          <block type="text"></block>
          <block type="colour_picker"></block>
          <block type="logic_boolean"></block>
        </category>
        <category name="Html" colour="%{BKY_COLOUR_HUE}">
          <block type="on_start"></block>
          <block type="element_clicked"></block>
          <block type="with_element_by_id"></block>
          <block type="add_element"></block>
          <block type="set_content">
            <value name="VALUE">
              <shadow type="text"> </shadow>
            </value>
          </block>
          <block type="set_attribute"></block>
          <block type="remove_contents"></block>
          <block type="element_clicked_current"></block>
          <block type="with_elements_by_selector"></block>
        </category>
        <category name="Arrays" colour="%{BKY_LISTS_HUE}">
          <block type="variables_set">
            <field name="VAR">array</field>
            <value name="VALUE">
              <block type="lists_create_with">
              </block>
            </value>
          </block>
          <block type="arrays_getFirst">
            <value name="VALUE">
              <block type="variables_get">
                  <field name="VAR">array</field>
              </block>
            </value>
          </block>
          <block type="arrays_push">
            <value name="LIST">
              <block type="variables_get">
                  <field name="VAR">array</field>
              </block>
            </value>
          </block>
          <block type="lists_isEmpty">
            <value name="VALUE">
              <block type="variables_get">
                  <field name="VAR">array</field>
              </block>
            </value>
          </block>
          <block type="arrays_forEach">
            <field name="VAR">item</field>
            </value>
            <value name="LIST">
              <block type="variables_get">
                  <field name="VAR">array</field>
              </block>
            </value>
          </block>
          <block type="get_sum">
            <value name="ARRAY">
              <block type="variables_get">
                  <field name="VAR">array</field>
              </block>
            </value>
          </block>
        </category>
        <category name="Variables" colour="330" custom="VARIABLE"></category>
      </xml>
      </div>

      
      <div class="exercise" id="exercise_arrays_buttons">
      <h2>Arrays and buttons</h2>
      <script>
        BlocklyTest.registerTest("exercise_arrays_buttons", () => {
          let ul = BlocklyTest.findElement(["#list", "ul", "ol"]);
          let button = BlocklyTest.findElement(["#button", "button"]);
          let arrayToBeRevealed = BlocklyTest.findArrayValues(0); // first of the arrays is the one we want
          let totalElementsAtEnd = arrayToBeRevealed.length;

          BlocklyTest.expectAfterClick(1, "Each click of the button adds an li", button, 
          () => {
            let count = ul ? ul.children.length : 0;
            return count;
          },
          (countBefore, countAfter) => {
            let addsExactlyOneChild = countBefore + 1 == countAfter;
            return addsExactlyOneChild;
          });

          BlocklyTest.expectAfterClick(2, "Each click of the button reveals a fruit", button, 
          () => {
            let count = ul ? ul.children.length : 0;
            return count;
          },
          (countBefore, countAfter) => {
            let addsExactlyOneChild = countBefore + 1 == countAfter;
            if (addsExactlyOneChild) {
              let lastLi = ul.lastChild;
              if (lastLi && lastLi.innerText == arrayToBeRevealed[0]) {
                arrayToBeRevealed.shift();
              }
            }
            return arrayToBeRevealed.length == 0;
          });

          BlocklyTest.expectAfterClick(3, "Each click of the button reveals a fruit", button, 
          () => {
            let count = ul ? ul.children.length : 0;
            return count;
          },
          (countBefore, countAfter) => {
            return arrayToBeRevealed.length == 0 && countBefore == countAfter && countBefore == totalElementsAtEnd
          });
        });
      </script>
      <div class="instructions">
        <zero-md src="exercises/arrays_buttons.md"></zero-md>
      </div>
      <xml class="toolbox" style="display: none">
        <category name="Logic" colour="210">
          <block type="controls_if"></block>
          <block type="logic_negate"></block>
          <block type="logic_compare"></block>
        </category>
        <category name="Values" colour='%{BKY_TEXTS_HUE}'>
          <block type="math_number"></block>
          <block type="text"></block>
          <block type="colour_picker"></block>
          <block type="logic_boolean"></block>
        </category>
        <category name="Html" colour="%{BKY_COLOUR_HUE}">
          <block type="on_start"></block>
          <block type="element_clicked"></block>
          <block type="with_element_by_id"></block>
          <block type="add_element"></block>
          <block type="set_content">
            <value name="VALUE">
              <shadow type="text"> </shadow>
            </value>
          </block>
          <block type="set_attribute"></block>
          <block type="remove_contents"></block>
          <block type="get_input_value_with_id"></block>
          <block type="element_clicked_current"></block>
          <block type="with_elements_by_selector"></block>
        </category>
        <category name="Arrays" colour="%{BKY_LISTS_HUE}">
          <block type="variables_set">
            <field name="VAR">array</field>
            <value name="VALUE">
              <block type="lists_create_with">
              </block>
            </value>
          </block>
          <block type="arrays_getFirst">
            <value name="VALUE">
              <block type="variables_get">
                  <field name="VAR">array</field>
              </block>
            </value>
          </block>
          <block type="arrays_push">
            <value name="LIST">
              <block type="variables_get">
                  <field name="VAR">array</field>
              </block>
            </value>
          </block>
          <block type="lists_isEmpty">
            <value name="VALUE">
              <block type="variables_get">
                  <field name="VAR">array</field>
              </block>
            </value>
          </block>
          <block type="arrays_forEach">
            <field name="VAR">item</field>
            </value>
            <value name="LIST">
              <block type="variables_get">
                  <field name="VAR">array</field>
              </block>
            </value>
          </block>
          <block type="get_sum">
            <value name="ARRAY">
              <block type="variables_get">
                  <field name="VAR">array</field>
              </block>
            </value>
          </block>
        </category>
        <category name="Variables" colour="330" custom="VARIABLE"></category>
      </xml>
      </div>
      
      <div class="exercise" id="exercise_array_while_loops">
      <h2>Loops and arrays: more fun with fruit</h2>
      <script>
        BlocklyTest.registerTest("exercise_array_while_loops", () => {
          let ul = BlocklyTest.findElement(["#list", "ul", "ol"]);
          let list = BlocklyTest.findArrayValues(0);
          let emojis = BlocklyTest.findArrayValues(1);

          BlocklyTest.expect(1, "All the elements in the list are in the html list.", ul, (ul) => {
            var lis = Array.from(ul.querySelectorAll("li"));
            return lis.length == list.length && lis.every((li, index) => li.innerText.startsWith(list[index]));
          });

          BlocklyTest.expect(2, "All the elements in the list are in the html list. There are 2 spans in each li", ul, (ul) => {
            var lis = Array.from(ul.querySelectorAll("li"));
            return lis.length == list.length && lis.every((li, index) => Array.from(li.querySelectorAll("span")).length == 2);
          });

          BlocklyTest.expect(3, "All the elements in the list are in the html list. There are at least 4 elements", ul, (ul) => {
            var lis = Array.from(ul.querySelectorAll("li"));
            return lis.length == list.length && lis.every((li, index) => li.innerText == list[index]+emojis[index]);
          });
        });
      </script>
      <div class="instructions">
        <zero-md src="exercises/array_while_loops.md"></zero-md>
      </div>
      <xml class="toolbox" style="display: none">
        <category name="Loops" colour="120">
        <block type="controls_whileUntil"></block>
        <block type="arrays_forEach">
          <field name="VAR">item</field>
          </value>
          <value name="LIST">
            <block type="variables_get">
                <field name="VAR">array</field>
            </block>
          </value>
        </block>
        <block type="controls_for"></block>
      </category>
        <category name="Logic" colour="210">
          <block type="controls_if"></block>
          <block type="logic_negate"></block>
          <block type="logic_compare"></block>
        </category>
        <category name="Values" colour='%{BKY_TEXTS_HUE}'>
          <block type="math_number"></block>
          <block type="text"></block>
          <block type="colour_picker"></block>
          <block type="logic_boolean"></block>
        </category>
        <category name="Html" colour="%{BKY_COLOUR_HUE}">
          <block type="on_start"></block>
          <block type="element_clicked"></block>
          <block type="with_element_by_id"></block>
          <block type="add_element"></block>
          <block type="set_content">
            <value name="VALUE">
              <shadow type="text"> </shadow>
            </value>
          </block>
          <block type="set_attribute"></block>
          <block type="remove_contents"></block>
          <block type="get_input_value_with_id"></block>
          <block type="element_clicked_current"></block>
          <block type="with_elements_by_selector"></block>
        </category>
        <category name="Arrays" colour="%{BKY_LISTS_HUE}">
          <block type="variables_set">
            <field name="VAR">array</field>
            <value name="VALUE">
              <block type="lists_create_with">
              </block>
            </value>
          </block>
          <block type="arrays_getFirst">
            <value name="VALUE">
              <block type="variables_get">
                  <field name="VAR">array</field>
              </block>
            </value>
          </block>
          <block type="arrays_push">
            <value name="LIST">
              <block type="variables_get">
                  <field name="VAR">array</field>
              </block>
            </value>
          </block>
          <block type="lists_isEmpty">
            <value name="VALUE">
              <block type="variables_get">
                  <field name="VAR">array</field>
              </block>
            </value>
          </block>
          <block type="arrays_forEach">
            <field name="VAR">item</field>
            </value>
            <value name="LIST">
              <block type="variables_get">
                  <field name="VAR">array</field>
              </block>
            </value>
          </block>
          <block type="get_sum">
            <value name="ARRAY">
              <block type="variables_get">
                  <field name="VAR">array</field>
              </block>
            </value>
          </block>
        </category>
        <category name="Variables" colour="330" custom="VARIABLE"></category>
      </xml>
      </div>

      <div class="exercise" id="exercise_arrays_add_sum">
      <h2>Arrays: Adding, removing, and summing elements</h2>
      <div class="instructions">
        <zero-md src="exercises/arrays_add_sum.md"></zero-md>
      </div>
      <xml class="toolbox" style="display: none">
        <category name="Logic" colour="210">
          <block type="controls_if"></block>
          <block type="logic_negate"></block>
          <block type="logic_compare"></block>
        </category>
        <category name="Values" colour='%{BKY_TEXTS_HUE}'>
          <block type="math_number"></block>
          <block type="text"></block>
          <block type="colour_picker"></block>
          <block type="logic_boolean"></block>
        </category>
        <category name="Html" colour="%{BKY_COLOUR_HUE}">
          <block type="on_start"></block>
          <block type="element_clicked"></block>
          <block type="with_element_by_id"></block>
          <block type="add_element"></block>
          <block type="set_content">
            <value name="VALUE">
              <shadow type="text"> </shadow>
            </value>
          </block>
          <block type="set_attribute"></block>
          <block type="remove_contents"></block>
          <block type="get_input_value_with_id"></block>
          <block type="element_clicked_current"></block>
          <block type="with_elements_by_selector"></block>
        </category>
        <category name="Arrays" colour="%{BKY_LISTS_HUE}">
          <block type="variables_set">
            <field name="VAR">array</field>
            <value name="VALUE">
              <block type="lists_create_with">
              </block>
            </value>
          </block>
          <block type="arrays_forEach">
            <field name="VAR">item</field>
            </value>
            <value name="LIST">
              <block type="variables_get">
                  <field name="VAR">array</field>
              </block>
            </value>
          </block>
          <block type="arrays_getFirst">
            <value name="VALUE">
              <block type="variables_get">
                  <field name="VAR">array</field>
              </block>
            </value>
          </block>
          <block type="arrays_push">
            <value name="LIST">
              <block type="variables_get">
                  <field name="VAR">array</field>
              </block>
            </value>
          </block>
        <block type="get_randomMember">
          <value name="ARRAY">
            <block type="variables_get">
                <field name="VAR">array</field>
            </block>
          </value>
        </block>
          <block type="get_sum">
          <value name="ARRAY">
            <block type="variables_get">
                <field name="VAR">array</field>
            </block>
          </value>
        </block>
        </category>
        <category name="Variables" colour="330" custom="VARIABLE"></category>
      </xml>
      </div>

      <div class="exercise" id="exercise_arrays_sum">
      <h2>Project: Don't go higher than 11!</h2>
      <div class="instructions">
      <p>We are now going to use all the array blocks we have learned about. We're going to create a game where you roll dice and your goal is to not total more than 11.
      </p>
      <ol>
          <li>Start with an empty list (where we will display our rolls), a place to put a total, and a few buttons (<code class="start_code">&lt;p&gt;So far you have rolled:&lt;/p&gt;<br>&lt;ul id="list"&gt;&lt;/ul&gt;<br>&lt;button id="button_roll"&gt;Roll the dice&lt;/button&gt;<br>&lt;p&gt;Total: &lt;span id="total"&gt;0&lt;/span&gt;. &lt;span id="info"&gt;Keep playing!&lt;/span&gt;&lt;/p&gt;<br>&lt;button id="button_remove"&gt;Remove the last roll&lt;/button&gt;<br>&lt;button id="button_restart"&gt;Start again&lt;/button&gt;</code></li>
          <li>The game has the following requirements. Before reading further, how would you break down and implement these requirements into steps? Think through what steps need to happen after each button click. In what order would you implement these steps so as to test each step as early as possible?<ul>
            <li>When "roll the dice" is clicked, a new random number between 1 and 6 should be generated and added</li>
            <li>If the total of all the dice rolls is exactly 11, display "You won" in the <code>&lt;span id="info"&gt;</code></li>
            <li>If the total of all the dice rolls is over 11, display "You lost" in the <code>&lt;span id="info"&gt;</code></li>
            <li>When "remove the last roll" is clicked, we should undo the last roll (this is a cheat button so that we can always win!)</li>
            <li>The list should display all the rolls so far</li>
            <li>The total so far should be displayed in the <code>&lt;span id="total"&gt;</code></li>
            <li>When "start again" is clicked, we should return to the initial state</li>
          </ul></li>
          <li>
            The following steps are needed. Notice that some of them repeat, some of them are similar, and that the game has a "state" which is the array of dice rolls. <ul>
            <li>At the beginning: <ol>
              <li>Display each roll in the array (there are currently no rolls)</li>
              <li>Display the total of all rolls (it is currently 0)</li>
            </ol></li>
            <li>When "roll the dice" is clicked: <ol>
              <li>Pick a random number between 1 and 6</li>
              <li>Add that number to the array of rolls</li>
              <li>Display each roll in the array</li>
              <li>Calculate the total of all rolls<ul>
                <li>If it is greater than 11, display "You lost"</li>
                <li>If it is equal to 11, display "You won"</li>
              </ul></li>
              <li>Display the total of all rolls</li>
            </ol></li>
            <li>When "Start again" is clicked: (this is the same as at the beginning)<ol>
              <li>Display each roll in the array (there are currently no rolls)</li>
              <li>Display the total of all rolls (it is currently 0)</li>
            </ol></li>
            <li>When "Remove the last roll" is clicked: <ol>
              <li>Remove the last roll from the array of rolls</li>
              <li>Display each roll in the array</li>
              <li>Calculate the total of all rolls<ul>
                <li>If it is greater than 11, display "You lost"</li>
                <li>If it is equal to 11, display "You won"</li>
                <li>If it is less than 11, display "Keep playing"</li>
              </ul></li>
              <li>Display the total of all rolls</li>
            </ol></li>
          </ul></li>
          <li>In order to check that anything is working, we need to be able to display an array of rolls and its total, so that's where we will start. <ol>
            <li>In an <span class="blockname">"At the start"</span> block, create an array called "rolls" and put 3 numbers in the array (afterwards we will start with an empty array, but for now having numbers helps)</li>
            <li>Using a loop, display each of the numbers in the array in the list. Check that your code works.</li>
            <li>Set the <code>&lt;span id="total"&gt;</code> to the sum of the numbers in the "rolls" array.</li>
            <li>We will put in the "you won"/"you lost"/"keep playing" logic in last (but you could also do it now if you like)</li>
          </ol></li>
          <li>Next, let's go with the simplest: the restart button <ol>
              <li>Add a <span class="blockname">"When the element with id ... is clicked"</span> block for this button</li>
              <li>We want to set the "rolls" variable to an empty list (Use the same blocks as you did to initialise the rolls variable, then use the gear icon to remove all the items from the array)</li>
              <li>We now want to remove the displayed rolls from the list (You will need to use the <span class="blockname">"Remove the contents of the element"</span> block)</li>
              <li>And we want to set the text <code>&lt;span id="total"&gt;</code> to 0</li>
          </ol></li>
          <li>Slightly more tricky: the "roll the dice" button. Before following the instructions, can you think how we could create a dice?<ol>
              <li>To create a dice, we'll create a new array in the <span class="blockname">"At the start"</span> block, called "dice" (be careful to select the "array" variable, not the "rolls" variable before renaming to "dice"), setting the values as the numbers 1, 2, 3, 4, 5, and 6. We can select a random item from this array when we want to roll a dice.</li>
              <li>Add a <span class="blockname">"When the element with id ... is clicked"</span> block for the button</li>
              <li>Let's roll the dice and add the result to the list. Use the <span class="blockname">"add ... to the start/end of the array"</span> block, setting the "end" of the "rolls" array, and using a <span class="blockname">"get random item from the array"</span> block as the value.</li>
              <li>We could now add a new <code>&lt;li&gt;</code> to the list and set the total. Instead, we are going to re-display the whole list from the array - you will see why in the next step</li>
              <li>To re-display the whole list (and set the total), we need a combination of the two previous steps: find the list, remove its contents, loop over the items in the array and add them to the list, set the total to the sum of the array.</li>
          </ol></li>
          <li>Notice that at this point, we have 3 different versions of the same steps to display the list contents and total. Now imagine we want to change something (like add the "you won"/"you lost"/"keep playing" information). We would have to add it in 3 different places! (And we still have a "remove last roll" button to implement - so it would be 4 places)<ol>
              <li>We can actually write this code so that is exactly the same all the times (looping over an empty array will do nothing, and it's sum will be 0). When we see a piece of code we would like to use multiple times, we create a function.</li>
              <li>From the Functions menu, select a <span class="blockname">"To <i>do something</i>"</span> block and call it "to <i>display the rolls</i>"</li>
              <li>Take all the display code you wrote in the previous step and move it to inside this function.</li>
              <li>In the Functions menu, there is now a <span class="blockname">"display the rolls"</span> block. You can us it as a replacement for the code you just moved. That block will "call" the function you created (this means it will execute all the blocks inside that function)</li>
              <li>You can replace the 2 other versions of your display code with the <span class="blockname">"display the rolls"</span> block.</li>
          </ol></li>
          <li>Now you can add the logic that decides what to put into the <code>&lt;span id="info"&gt;</code>. <ol>
              <li>Hint: You can calculate the sum of the array only once and store the result in a variable.</li>
              <li>Hint: You can add else if and else conditions to the <span class="blockname">"if"</span> block by clicking on the gear icon.</li>
              <li>To test all the logic, put different values into the initial rolls array. Once this is working, you can set the initial rolls array to an empty list.</li>
          </ol></li>
          <li>Last it's time to create our "cheat" functionality, the "Remove the last roll" button.<ol>
              <li>You already know how to do remove the first item from an array. You can use the same block to remove the last item</li>
              <li>Don't forget to call the <span class="blockname">"display the rolls"</span> function!</li>
          </ol></li>
      </ol>
      </div>
      <xml class="toolbox" style="display: none">
        <category name="Logic" colour="210">
          <block type="controls_if"></block>
          <block type="logic_negate"></block>
          <block type="logic_compare"></block>
        </category>
        <category name="Values" colour='%{BKY_TEXTS_HUE}'>
          <block type="math_number"></block>
          <block type="text"></block>
          <block type="colour_picker"></block>
          <block type="logic_boolean"></block>
        </category>
        <category name="Html" colour="%{BKY_COLOUR_HUE}">
          <block type="on_start"></block>
          <block type="element_clicked"></block>
          <block type="with_element_by_id"></block>
          <block type="add_element"></block>
          <block type="set_content">
            <value name="VALUE">
              <shadow type="text"> </shadow>
            </value>
          </block>
          <block type="set_attribute"></block>
          <block type="remove_contents"></block>
          <block type="get_input_value_with_id"></block>
          <block type="element_clicked_current"></block>
          <block type="with_elements_by_selector"></block>
        </category>
        <category name="Arrays" colour="%{BKY_LISTS_HUE}">
          <block type="variables_set">
            <field name="VAR">array</field>
            <value name="VALUE">
              <block type="lists_create_with">
              </block>
            </value>
          </block>
          <block type="arrays_forEach">
            <field name="VAR">item</field>
            </value>
            <value name="LIST">
              <block type="variables_get">
                  <field name="VAR">array</field>
              </block>
            </value>
          </block>
          <block type="arrays_getFirst">
            <value name="VALUE">
              <block type="variables_get">
                  <field name="VAR">array</field>
              </block>
            </value>
          </block>
          <block type="arrays_push">
            <value name="LIST">
              <block type="variables_get">
                  <field name="VAR">array</field>
              </block>
            </value>
          </block>
        <block type="get_randomMember">
          <value name="ARRAY">
            <block type="variables_get">
                <field name="VAR">array</field>
            </block>
          </value>
        </block>
          <block type="get_sum">
          <value name="ARRAY">
            <block type="variables_get">
                <field name="VAR">array</field>
            </block>
          </value>
        </block>
        </category>
        <category name="Variables" colour="330" custom="VARIABLE"></category>
        <category name="Functions" colour="290" custom="PROCEDURE"></category>
      </xml>
      </div>

      
      <div class="exercise" id="exercise_random_facilitator">
      <h2>Project: Select a random facilitator</h2>
      <div class="instructions">
        <zero-md src="exercises/random_facilitator.md"></zero-md>
      </div>
      </div>

      <div class="exercise" id="exercise_earnings_expenses">
      <h2>Project: Show earnings and expenses</h2>
      <div class="instructions">
        <zero-md src="exercises/earnings_expenses.md"></zero-md>
      </div>
      </div>
      
      <div class="exercise" id="exercise_list_consolidation">
      <h2>Project: List of links</h2>
      <div class="instructions">
        <zero-md src="exercises/list_consolidation.md"></zero-md>
      </div>
      </div>
      
      <div class="exercise" id="exercise_story_book">
      <h2>Project: Create a story book</h2>
      <div class="instructions">
        <zero-md src="exercises/story_book.md"></zero-md>
      </div>
      </div>
      
      <div class="exercise" id="exercise_image_carousel">
      <h2>Project: Build an image carousel</h2>
      <div class="instructions">
        <zero-md src="exercises/image_carousel.md"> </zero-md>
      </div>
      </div>
    
      <div class="exercise" id="exercise_projects">
      <h2>Some more "projects"</h2>
      <div class="instructions">
        <zero-md src="exercises/more_projects.md"></zero-md>
      </div>

    <footer>
      <h3>CYF Blocks is a project of <a href="https://codeyourfuture.io">Code Your Future</a></h3>
      <p>Recap your HTML/CSS knowledge with this <a href="https://scrimba.com/learn/htmlcss">free crash course</a> on Scrimba.</p>
    </footer>
     <section role="dialog" aria-live="assertive" class="toast" id="toast" aria-labelledby="toast-title">
      <h4 class="toast-title"></h4>
    </section>
    <xml id="toolbox" style="display: none">
      <category name="Loops" colour="120">
        <block type="controls_whileUntil"></block>
        <block type="arrays_forEach">
          <field name="VAR">item</field>
          </value>
          <value name="LIST">
            <block type="variables_get">
                <field name="VAR">array</field>
            </block>
          </value>
        </block>
        <block type="controls_for"></block>
      </category>
      <category name="Logic" colour="210">
        <block type="controls_if"></block>
        <block type="logic_negate"></block>
        <block type="logic_compare"></block>
      </category>
      <category name="Values" colour='%{BKY_TEXTS_HUE}'>
        <block type="math_number"></block>
        <block type="text"></block>
        <block type="colour_picker"></block>
        <block type="logic_boolean"></block>
        <block type="get_randomWord"></block>
        <block type="text_to_speech"></block>
      </category>
      <category name="Html" colour="%{BKY_COLOUR_HUE}">
        <block type="on_start"></block>
        <block type="element_clicked"></block>
        <block type="with_element_by_id"></block>
        <block type="add_element"></block>
        <block type="set_content">
          <value name="VALUE">
            <shadow type="text"> </shadow>
          </value>
        </block>
        <block type="set_attribute"></block>
        <block type="remove_contents"></block>
        <block type="get_input_value_with_id"></block>
        <block type="element_clicked_current"></block>
        <block type="with_elements_by_selector"></block>
      </category>
      <category name="Arrays" colour="%{BKY_LISTS_HUE}"" >
        <block type="variables_set">
          <field name="VAR">array</field>
          <value name="VALUE">
            <block type="lists_create_with">
              <!--
              would be nice but the shadow blocks don't know what to do with themselves when the list
              is mutated -> https://github.com/google/blockly/issues/4939
              <value name="ADD0">
                <shadow type="text"> </shadow>
              </value>
              <value name="ADD1">
                <shadow type="text"> </shadow>
              </value>
              <value name="ADD2">
                <shadow type="text"> </shadow>
              </value>-->
            </block>
          </value>
        </block>
        <block type="arrays_getFirst">
          <value name="VALUE">
            <block type="variables_get">
                <field name="VAR">array</field>
            </block>
          </value>
        </block>
        <block type="arrays_push">
          <value name="LIST">
            <block type="variables_get">
                <field name="VAR">array</field>
            </block>
          </value>
        </block>
        <block type="lists_isEmpty">
          <value name="VALUE">
            <block type="variables_get">
                <field name="VAR">array</field>
            </block>
          </value>
        </block>
        <block type="arrays_forEach">
          <field name="VAR">item</field>
          </value>
          <value name="LIST">
            <block type="variables_get">
                <field name="VAR">array</field>
            </block>
          </value>
        </block>
        <block type="get_randomMember">
          <value name="ARRAY">
            <block type="variables_get">
                <field name="VAR">array</field>
            </block>
          </value>
        </block>
        <block type="get_sum">
          <value name="ARRAY">
            <block type="variables_get">
                <field name="VAR">array</field>
            </block>
          </value>
        </block>
      </category>
      <!--<category name="Lists" colour="%{BKY_LISTS_HUE}"" >
        <block type="variables_set">
          <field name="VAR">list</field>
          <value name="VALUE">
            <block type="linked_lists_create_with"> </block>
          </value>
        </block>
        <block type="linked_lists_get_current">
          <value name="VALUE">
            <block type="variables_get">
                <field name="VAR">list</field>
            </block>
          </value>
        </block>
        <block type="linked_lists_set_current">
          <value name="VALUE">
            <block type="variables_get">
                <field name="VAR">list</field>
            </block>
          </value>
        </block>
        <block type="linked_lists_has_current">
          <value name="VALUE">
            <block type="variables_get">
                <field name="VAR">list</field>
            </block>
          </value>
        </block>
        <block type="linked_lists_has_next">
          <value name="VALUE">
            <block type="variables_get">
                <field name="VAR">list</field>
            </block>
          </value>
        </block>
        <block type="linked_lists_has_previous">
          <value name="VALUE">
            <block type="variables_get">
                <field name="VAR">list</field>
            </block>
          </value>
        </block>
      </category>-->
      <category name="Variables" colour="330" custom="VARIABLE"></category>
      <category name="Functions" colour="290" custom="PROCEDURE"></category>
    </xml>
    <script src="exercises.js"></script>
</body>
</html>
